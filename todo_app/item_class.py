from todo_app.flask_config import Config
import os
from todo_app.list_class import list
import requests
import json
import datetime

trello_authorisation = {'key': os.environ.get('API_KEY'),'token': os.environ.get('TOKEN')}

def get_items_on_a_board():
    if os.environ.get('FLASK_ENV') == 'development':
        items_on_board = requests.get('https://api.trello.com/1/boards/' + Config.TRELLO_BOARD + '/cards', params = trello_authorisation)
        return items_on_board.json()
    else:
        items_on_board = '[{"id":"5fc6941c796b150565cb3836","checkItemStates":null,"closed":false,"dateLastActivity":"2020-12-01T19:06:04.264Z","desc":"","descData":null,"dueReminder":null,"idBoard":"5f74ee5411e69a45a1114b0a","idList":"5f74ee55fbd0d027af5f8d6f","idMembersVoted":[],"idShort":27,"idAttachmentCover":null,"idLabels":[],"manualCoverAttachment":false,"name":"dddd","pos":65536,"shortLink":"HfaLwvtm","isTemplate":false,"cardRole":null,"badges":{"attachmentsByType":{"trello":{"board":0,"card":0}},"location":false,"votes":0,"viewingMemberVoted":false,"subscribed":false,"fogbugz":"","checkItems":0,"checkItemsChecked":0,"checkItemsEarliestDue":null,"comments":0,"attachments":0,"description":false,"due":null,"dueComplete":false,"start":null},"dueComplete":false,"due":null,"idChecklists":[],"idMembers":[],"labels":[],"shortUrl":"https://trello.com/c/HfaLwvtm","start":null,"subscribed":false,"url":"https://trello.com/c/HfaLwvtm/27-dddd","cover":{"idAttachment":null,"color":null,"idUploadedBackground":null,"size":"normal","brightness":"light"}},{"id":"5fc7bff164b13b163068af72","checkItemStates":null,"closed":false,"dateLastActivity":"2020-12-02T16:25:21.999Z","desc":"","descData":null,"dueReminder":null,"idBoard":"5f74ee5411e69a45a1114b0a","idList":"5f74ee55fbd0d027af5f8d6f","idMembersVoted":[],"idShort":30,"idAttachmentCover":null,"idLabels":[],"manualCoverAttachment":false,"name":"qqq","pos":81920,"shortLink":"mxKUb27d","isTemplate":false,"cardRole":null,"badges":{"attachmentsByType":{"trello":{"board":0,"card":0}},"location":false,"votes":0,"viewingMemberVoted":false,"subscribed":false,"fogbugz":"","checkItems":0,"checkItemsChecked":0,"checkItemsEarliestDue":null,"comments":0,"attachments":0,"description":false,"due":null,"dueComplete":false,"start":null},"dueComplete":false,"due":null,"idChecklists":[],"idMembers":[],"labels":[],"shortUrl":"https://trello.com/c/mxKUb27d","start":null,"subscribed":false,"url":"https://trello.com/c/mxKUb27d/30-qqq","cover":{"idAttachment":null,"color":null,"idUploadedBackground":null,"size":"normal","brightness":"light"}},{"id":"5fcd4a33adc0596682f1e428","checkItemStates":null,"closed":false,"dateLastActivity":"2020-12-06T21:16:35.210Z","desc":"","descData":null,"dueReminder":null,"idBoard":"5f74ee5411e69a45a1114b0a","idList":"5f74ee55fbd0d027af5f8d6f","idMembersVoted":[],"idShort":32,"idAttachmentCover":null,"idLabels":[],"manualCoverAttachment":false,"name":"","pos":98304,"shortLink":"PxBbB9Fs","isTemplate":false,"cardRole":null,"badges":{"attachmentsByType":{"trello":{"board":0,"card":0}},"location":false,"votes":0,"viewingMemberVoted":false,"subscribed":false,"fogbugz":"","checkItems":0,"checkItemsChecked":0,"checkItemsEarliestDue":null,"comments":0,"attachments":0,"description":false,"due":null,"dueComplete":false,"start":null},"dueComplete":false,"due":null,"idChecklists":[],"idMembers":[],"labels":[],"shortUrl":"https://trello.com/c/PxBbB9Fs","start":null,"subscribed":false,"url":"https://trello.com/c/PxBbB9Fs/32--","cover":{"idAttachment":null,"color":null,"idUploadedBackground":null,"size":"normal","brightness":"light"}},{"id":"5fcd4bcac9d28a3b2a7b526b","checkItemStates":null,"closed":false,"dateLastActivity":"2020-12-06T21:23:22.951Z","desc":"","descData":null,"dueReminder":null,"idBoard":"5f74ee5411e69a45a1114b0a","idList":"5f74ee55fbd0d027af5f8d6f","idMembersVoted":[],"idShort":34,"idAttachmentCover":null,"idLabels":[],"manualCoverAttachment":false,"name":"nick","pos":131072,"shortLink":"Wt4jF4QA","isTemplate":false,"cardRole":null,"badges":{"attachmentsByType":{"trello":{"board":0,"card":0}},"location":false,"votes":0,"viewingMemberVoted":false,"subscribed":false,"fogbugz":"","checkItems":0,"checkItemsChecked":0,"checkItemsEarliestDue":null,"comments":0,"attachments":0,"description":false,"due":null,"dueComplete":false,"start":null},"dueComplete":false,"due":null,"idChecklists":[],"idMembers":[],"labels":[],"shortUrl":"https://trello.com/c/Wt4jF4QA","start":null,"subscribed":false,"url":"https://trello.com/c/Wt4jF4QA/34-nick","cover":{"idAttachment":null,"color":null,"idUploadedBackground":null,"size":"normal","brightness":"light"}},{"id":"5fc6943cf3843045de44bf73","checkItemStates":null,"closed":false,"dateLastActivity":"2020-12-02T16:22:16.830Z","desc":"","descData":null,"dueReminder":null,"idBoard":"5f74ee5411e69a45a1114b0a","idList":"5f74ee55bf26d32a3e6b277e","idMembersVoted":[],"idShort":28,"idAttachmentCover":null,"idLabels":[],"manualCoverAttachment":false,"name":"ssss","pos":81920,"shortLink":"YGtCA7if","isTemplate":false,"cardRole":null,"badges":{"attachmentsByType":{"trello":{"board":0,"card":0}},"location":false,"votes":0,"viewingMemberVoted":false,"subscribed":false,"fogbugz":"","checkItems":0,"checkItemsChecked":0,"checkItemsEarliestDue":null,"comments":0,"attachments":0,"description":false,"due":null,"dueComplete":false,"start":null},"dueComplete":false,"due":null,"idChecklists":[],"idMembers":[],"labels":[],"shortUrl":"https://trello.com/c/YGtCA7if","start":null,"subscribed":false,"url":"https://trello.com/c/YGtCA7if/28-ssss","cover":{"idAttachment":null,"color":null,"idUploadedBackground":null,"size":"normal","brightness":"light"}},{"id":"5f74ee55c187b301c9a1f9d2","checkItemStates":null,"closed":false,"dateLastActivity":"2020-10-03T14:16:58.064Z","desc":"","descData":null,"dueReminder":null,"idBoard":"5f74ee5411e69a45a1114b0a","idList":"5f74ee5505790c8355378641","idMembersVoted":[],"idShort":3,"idAttachmentCover":null,"idLabels":[],"manualCoverAttachment":false,"name":"get a valuation","pos":2.5,"shortLink":"q4Adhd53","isTemplate":false,"cardRole":null,"badges":{"attachmentsByType":{"trello":{"board":0,"card":0}},"location":false,"votes":0,"viewingMemberVoted":false,"subscribed":false,"fogbugz":"","checkItems":1,"checkItemsChecked":0,"checkItemsEarliestDue":null,"comments":0,"attachments":0,"description":false,"due":null,"dueComplete":false,"start":null},"dueComplete":false,"due":null,"idChecklists":["5f74ee56bbc980413769a597"],"idMembers":[],"labels":[],"shortUrl":"https://trello.com/c/q4Adhd53","start":null,"subscribed":false,"url":"https://trello.com/c/q4Adhd53/3-get-a-valuation","cover":{"idAttachment":null,"color":null,"idUploadedBackground":null,"size":"normal","brightness":"light"}},{"id":"5f74ee55cd59be5d864e79e7","checkItemStates":null,"closed":false,"dateLastActivity":"2020-12-01T19:35:38.664Z","desc":"","descData":null,"dueReminder":null,"idBoard":"5f74ee5411e69a45a1114b0a","idList":"5f74ee5505790c8355378641","idMembersVoted":[],"idShort":2,"idAttachmentCover":null,"idLabels":[],"manualCoverAttachment":false,"name":"find estate agent","pos":3,"shortLink":"QoXf0hIq","isTemplate":false,"cardRole":null,"badges":{"attachmentsByType":{"trello":{"board":0,"card":0}},"location":false,"votes":0,"viewingMemberVoted":false,"subscribed":false,"fogbugz":"","checkItems":0,"checkItemsChecked":0,"checkItemsEarliestDue":null,"comments":0,"attachments":0,"description":false,"due":null,"dueComplete":false,"start":null},"dueComplete":false,"due":null,"idChecklists":[],"idMembers":[],"labels":[],"shortUrl":"https://trello.com/c/QoXf0hIq","start":null,"subscribed":false,"url":"https://trello.com/c/QoXf0hIq/2-find-estate-agent","cover":{"idAttachment":null,"color":null,"idUploadedBackground":null,"size":"normal","brightness":"light"}},{"id":"5fc68e65ebec48845c794658","checkItemStates":null,"closed":false,"dateLastActivity":"2020-12-01T19:31:04.783Z","desc":"","descData":null,"dueReminder":null,"idBoard":"5f74ee5411e69a45a1114b0a","idList":"5f74ee5505790c8355378641","idMembersVoted":[],"idShort":23,"idAttachmentCover":null,"idLabels":[],"manualCoverAttachment":false,"name":"task1","pos":16384,"shortLink":"frGDYErY","isTemplate":false,"cardRole":null,"badges":{"attachmentsByType":{"trello":{"board":0,"card":0}},"location":false,"votes":0,"viewingMemberVoted":false,"subscribed":false,"fogbugz":"","checkItems":0,"checkItemsChecked":0,"checkItemsEarliestDue":null,"comments":0,"attachments":0,"description":false,"due":null,"dueComplete":false,"start":null},"dueComplete":false,"due":null,"idChecklists":[],"idMembers":[],"labels":[],"shortUrl":"https://trello.com/c/frGDYErY","start":null,"subscribed":false,"url":"https://trello.com/c/frGDYErY/23-task1","cover":{"idAttachment":null,"color":null,"idUploadedBackground":null,"size":"normal","brightness":"light"}},{"id":"5fc68e8cc54e3e46e7acfb81","checkItemStates":null,"closed":false,"dateLastActivity":"2020-12-01T19:37:22.580Z","desc":"","descData":null,"dueReminder":null,"idBoard":"5f74ee5411e69a45a1114b0a","idList":"5f74ee5505790c8355378641","idMembersVoted":[],"idShort":24,"idAttachmentCover":null,"idLabels":[],"manualCoverAttachment":false,"name":"task3","pos":32768,"shortLink":"sXOAws5I","isTemplate":false,"cardRole":null,"badges":{"attachmentsByType":{"trello":{"board":0,"card":0}},"location":false,"votes":0,"viewingMemberVoted":false,"subscribed":false,"fogbugz":"","checkItems":0,"checkItemsChecked":0,"checkItemsEarliestDue":null,"comments":0,"attachments":0,"description":false,"due":null,"dueComplete":false,"start":null},"dueComplete":false,"due":null,"idChecklists":[],"idMembers":[],"labels":[],"shortUrl":"https://trello.com/c/sXOAws5I","start":null,"subscribed":false,"url":"https://trello.com/c/sXOAws5I/24-task3","cover":{"idAttachment":null,"color":null,"idUploadedBackground":null,"size":"normal","brightness":"light"}},{"id":"5fc690214c7fdd31a93a0fbe","checkItemStates":null,"closed":false,"dateLastActivity":"2020-12-01T19:41:23.999Z","desc":"","descData":null,"dueReminder":null,"idBoard":"5f74ee5411e69a45a1114b0a","idList":"5f74ee5505790c8355378641","idMembersVoted":[],"idShort":26,"idAttachmentCover":null,"idLabels":[],"manualCoverAttachment":false,"name":"nick3","pos":65536,"shortLink":"zhBqLiOs","isTemplate":false,"cardRole":null,"badges":{"attachmentsByType":{"trello":{"board":0,"card":0}},"location":false,"votes":0,"viewingMemberVoted":false,"subscribed":false,"fogbugz":"","checkItems":0,"checkItemsChecked":0,"checkItemsEarliestDue":null,"comments":0,"attachments":0,"description":false,"due":null,"dueComplete":false,"start":null},"dueComplete":false,"due":null,"idChecklists":[],"idMembers":[],"labels":[],"shortUrl":"https://trello.com/c/zhBqLiOs","start":null,"subscribed":false,"url":"https://trello.com/c/zhBqLiOs/26-nick3","cover":{"idAttachment":null,"color":null,"idUploadedBackground":null,"size":"normal","brightness":"light"}},{"id":"5f74ee680ec40b767fc0c6c4","checkItemStates":null,"closed":false,"dateLastActivity":"2020-12-01T19:42:19.401Z","desc":"","descData":null,"dueReminder":null,"idBoard":"5f74ee5411e69a45a1114b0a","idList":"5f74ee5505790c8355378641","idMembersVoted":[],"idShort":4,"idAttachmentCover":null,"idLabels":[],"manualCoverAttachment":false,"name":"put house on the market","pos":65539,"shortLink":"jp6BHoIy","isTemplate":false,"cardRole":null,"badges":{"attachmentsByType":{"trello":{"board":0,"card":0}},"location":false,"votes":0,"viewingMemberVoted":false,"subscribed":false,"fogbugz":"","checkItems":0,"checkItemsChecked":0,"checkItemsEarliestDue":null,"comments":0,"attachments":0,"description":false,"due":null,"dueComplete":false,"start":null},"dueComplete":false,"due":null,"idChecklists":[],"idMembers":[],"labels":[],"shortUrl":"https://trello.com/c/jp6BHoIy","start":null,"subscribed":false,"url":"https://trello.com/c/jp6BHoIy/4-put-house-on-the-market","cover":{"idAttachment":null,"color":null,"idUploadedBackground":null,"size":"normal","brightness":"light"}},{"id":"5fc694d0b1dbe9647f8ef5e3","checkItemStates":null,"closed":false,"dateLastActivity":"2020-12-08T16:16:53.581Z","desc":"","descData":null,"dueReminder":null,"idBoard":"5f74ee5411e69a45a1114b0a","idList":"5f74ee5505790c8355378641","idMembersVoted":[],"idShort":29,"idAttachmentCover":null,"idLabels":[],"manualCoverAttachment":false,"name":"qq","pos":98304,"shortLink":"ire2jnMq","isTemplate":false,"cardRole":null,"badges":{"attachmentsByType":{"trello":{"board":0,"card":0}},"location":false,"votes":0,"viewingMemberVoted":false,"subscribed":false,"fogbugz":"","checkItems":0,"checkItemsChecked":0,"checkItemsEarliestDue":null,"comments":0,"attachments":0,"description":false,"due":null,"dueComplete":false,"start":null},"dueComplete":false,"due":null,"idChecklists":[],"idMembers":[],"labels":[],"shortUrl":"https://trello.com/c/ire2jnMq","start":null,"subscribed":false,"url":"https://trello.com/c/ire2jnMq/29-qq","cover":{"idAttachment":null,"color":null,"idUploadedBackground":null,"size":"normal","brightness":"light"}},{"id":"5fc7c471b717353f517b3ef5","checkItemStates":null,"closed":false,"dateLastActivity":"2020-12-02T16:46:39.191Z","desc":"","descData":null,"dueReminder":null,"idBoard":"5f74ee5411e69a45a1114b0a","idList":"5f74ee5505790c8355378641","idMembersVoted":[],"idShort":31,"idAttachmentCover":null,"idLabels":[],"manualCoverAttachment":false,"name":"aaa","pos":98304,"shortLink":"0OujQEnL","isTemplate":false,"cardRole":null,"badges":{"attachmentsByType":{"trello":{"board":0,"card":0}},"location":false,"votes":0,"viewingMemberVoted":false,"subscribed":false,"fogbugz":"","checkItems":0,"checkItemsChecked":0,"checkItemsEarliestDue":null,"comments":0,"attachments":0,"description":false,"due":null,"dueComplete":false,"start":null},"dueComplete":false,"due":null,"idChecklists":[],"idMembers":[],"labels":[],"shortUrl":"https://trello.com/c/0OujQEnL","start":null,"subscribed":false,"url":"https://trello.com/c/0OujQEnL/31-aaa","cover":{"idAttachment":null,"color":null,"idUploadedBackground":null,"size":"normal","brightness":"light"}},{"id":"5f74ee7df0f14c4b4e049678","checkItemStates":null,"closed":false,"dateLastActivity":"2020-12-01T18:54:45.276Z","desc":"","descData":null,"dueReminder":null,"idBoard":"5f74ee5411e69a45a1114b0a","idList":"5f74ee5505790c8355378641","idMembersVoted":[],"idShort":6,"idAttachmentCover":null,"idLabels":[],"manualCoverAttachment":false,"name":"accept offers","pos":196611,"shortLink":"4rRbIk3R","isTemplate":false,"cardRole":null,"badges":{"attachmentsByType":{"trello":{"board":0,"card":0}},"location":false,"votes":0,"viewingMemberVoted":false,"subscribed":false,"fogbugz":"","checkItems":0,"checkItemsChecked":0,"checkItemsEarliestDue":null,"comments":0,"attachments":0,"description":false,"due":null,"dueComplete":false,"start":null},"dueComplete":false,"due":null,"idChecklists":[],"idMembers":[],"labels":[],"shortUrl":"https://trello.com/c/4rRbIk3R","start":null,"subscribed":false,"url":"https://trello.com/c/4rRbIk3R/6-accept-offers","cover":{"idAttachment":null,"color":null,"idUploadedBackground":null,"size":"normal","brightness":"light"}},{"id":"5f74ee923daba9197a686a55","checkItemStates":null,"closed":false,"dateLastActivity":"2020-12-02T16:24:04.969Z","desc":"","descData":null,"dueReminder":null,"idBoard":"5f74ee5411e69a45a1114b0a","idList":"5f74ee5505790c8355378641","idMembersVoted":[],"idShort":7,"idAttachmentCover":null,"idLabels":[],"manualCoverAttachment":false,"name":"get solicitor","pos":262147,"shortLink":"oi6JIBL2","isTemplate":false,"cardRole":null,"badges":{"attachmentsByType":{"trello":{"board":0,"card":0}},"location":false,"votes":0,"viewingMemberVoted":false,"subscribed":false,"fogbugz":"","checkItems":0,"checkItemsChecked":0,"checkItemsEarliestDue":null,"comments":0,"attachments":0,"description":false,"due":null,"dueComplete":false,"start":null},"dueComplete":false,"due":null,"idChecklists":[],"idMembers":[],"labels":[],"shortUrl":"https://trello.com/c/oi6JIBL2","start":null,"subscribed":false,"url":"https://trello.com/c/oi6JIBL2/7-get-solicitor","cover":{"idAttachment":null,"color":null,"idUploadedBackground":null,"size":"normal","brightness":"light"}},{"id":"5f7901fa87a20a4ed5fff0b0","checkItemStates":null,"closed":false,"dateLastActivity":"2020-10-04T13:43:34.576Z","desc":"","descData":null,"dueReminder":null,"idBoard":"5f74ee5411e69a45a1114b0a","idList":"5f74ee5505790c8355378641","idMembersVoted":[],"idShort":8,"idAttachmentCover":null,"idLabels":[],"manualCoverAttachment":false,"name":"my list","pos":278531,"shortLink":"QVNZ1Wwh","isTemplate":false,"cardRole":null,"badges":{"attachmentsByType":{"trello":{"board":0,"card":0}},"location":false,"votes":0,"viewingMemberVoted":false,"subscribed":false,"fogbugz":"","checkItems":0,"checkItemsChecked":0,"checkItemsEarliestDue":null,"comments":0,"attachments":0,"description":false,"due":null,"dueComplete":false,"start":null},"dueComplete":false,"due":null,"idChecklists":[],"idMembers":[],"labels":[],"shortUrl":"https://trello.com/c/QVNZ1Wwh","start":null,"subscribed":false,"url":"https://trello.com/c/QVNZ1Wwh/8-my-list","cover":{"idAttachment":null,"color":null,"idUploadedBackground":null,"size":"normal","brightness":"light"}},{"id":"5fc68a35d796e96effadefb8","checkItemStates":null,"closed":false,"dateLastActivity":"2020-12-01T19:34:43.648Z","desc":"","descData":null,"dueReminder":null,"idBoard":"5f74ee5411e69a45a1114b0a","idList":"5f74ee5505790c8355378641","idMembersVoted":[],"idShort":22,"idAttachmentCover":null,"idLabels":[],"manualCoverAttachment":false,"name":"task2","pos":425987,"shortLink":"ozddGogq","isTemplate":false,"cardRole":null,"badges":{"attachmentsByType":{"trello":{"board":0,"card":0}},"location":false,"votes":0,"viewingMemberVoted":false,"subscribed":false,"fogbugz":"","checkItems":0,"checkItemsChecked":0,"checkItemsEarliestDue":null,"comments":0,"attachments":0,"description":false,"due":null,"dueComplete":false,"start":null},"dueComplete":false,"due":null,"idChecklists":[],"idMembers":[],"labels":[],"shortUrl":"https://trello.com/c/ozddGogq","start":null,"subscribed":false,"url":"https://trello.com/c/ozddGogq/22-task2","cover":{"idAttachment":null,"color":null,"idUploadedBackground":null,"size":"normal","brightness":"light"}},{"id":"5fc6350d2791da15f1840afe","checkItemStates":null,"closed":false,"dateLastActivity":"2020-12-02T14:30:59.880Z","desc":"","descData":null,"dueReminder":null,"idBoard":"5f74ee5411e69a45a1114b0a","idList":"5f74ee5505790c8355378641","idMembersVoted":[],"idShort":21,"idAttachmentCover":null,"idLabels":[],"manualCoverAttachment":false,"name":"","pos":458755,"shortLink":"tHGERDux","isTemplate":false,"cardRole":null,"badges":{"attachmentsByType":{"trello":{"board":0,"card":0}},"location":false,"votes":0,"viewingMemberVoted":false,"subscribed":false,"fogbugz":"","checkItems":0,"checkItemsChecked":0,"checkItemsEarliestDue":null,"comments":0,"attachments":0,"description":false,"due":null,"dueComplete":false,"start":null},"dueComplete":false,"due":null,"idChecklists":[],"idMembers":[],"labels":[],"shortUrl":"https://trello.com/c/tHGERDux","start":null,"subscribed":false,"url":"https://trello.com/c/tHGERDux/21--","cover":{"idAttachment":null,"color":null,"idUploadedBackground":null,"size":"normal","brightness":"light"}}]'

        
        items_on_board_json = json.loads(items_on_board)
        return items_on_board_json

def get_card_object(card_id):
    if os.environ.get('FLASK_ENV') == 'development':
        get_target_card = requests.get('https://api.trello.com/1/cards/' + card_id, params = trello_authorisation)
        get_target_card_json = get_target_card.json()
        return get_target_card_json
    else:
        get_test_card = '{"id":"5f74ee5505790c8355378641","name":"Done","closed":false,"pos":3,"softLimit":null,"creationMethod":"assisted","idBoard":"5f74ee5411e69a45a1114b0a","limits":{"cards":{"openPerList":{"status":"ok","disableAt":5000,"warnAt":4500},"totalPerList":{"status":"ok","disableAt":1000000,"warnAt":900000}}},"subscribed":false}'
        get_test_card_json = json.loads(get_test_card)
        return get_test_card_json


def get_status_name(card_id):
    status_name = requests.get('https://api.trello.com/1/cards/' + card_id +'/list', params = trello_authorisation)
    status_name_json = status_name.json()
    return status_name_json["name"]

def get_progress_list(list_id):
    next_list_response = requests.get('https://api.trello.com/1/boards/' + Config.TRELLO_BOARD + '/lists', params = trello_authorisation)
    use_next_list_entry = False
    card_progress = "todo"
    list_loop_iterations = 0
    for mylist in next_list_response.json():
        if use_next_list_entry == True:
            use_next_list_entry = False
            next_list_name = mylist["name"]
            next_list_id = mylist["id"]
            break

        if mylist["id"] == list_id:
            use_next_list_entry = True
            
        list_loop_iterations = list_loop_iterations + 1
 
    if list_loop_iterations != 1:
        card_progress = "inprogress"

    ##the card is already on the final list e.g completed
    if use_next_list_entry == True:
        next_list_name = "xxLastListxx"
        card_progress = "done"
        next_list_id = list_id
    
    next_list_dict = {'name':next_list_name, 'id': next_list_id, 'progress':  card_progress}

    return next_list_dict

def get_list_progress(list_id):
    get_next_list_dict = get_progress_list(list_id)
    return get_next_list_dict["progress"]

def check_if_task_recently_completed(target_card):
    currentDateFormatted = get_current_date()
    lastActivityDate = format_card_last_activity_date(target_card["dateLastActivity"])
    if lastActivityDate == currentDateFormatted:
        return "recent"
    else:
        return "older"


def get_current_date():
    return datetime.datetime.today().strftime ('%d-%b-%Y')

def format_card_last_activity_date(last_activity_date_string):
    date_object = datetime.datetime.strptime(last_activity_date_string, '%Y-%m-%dT%H:%M:%S.%fZ')
    return date_object.strftime ('%d-%b-%Y')

class item:
    def __init__(self,idShort, card_name, card_id, list_id, showToDoItems, showProgressingItems, showCompletedJobs, showCompletedRadio ):
        self.idShort = idShort
        self.card_id = card_id
        self.card_name = card_name
        self.status = get_status_name(card_id)
        self.list = list(list_id)
        self.progress = get_progress_list(list_id)
        self.showItemsToDo = showToDoItems
        self.showProgressing = showProgressingItems
        self.showCompleted = showCompletedJobs
        self.showCompletedRadio = showCompletedRadio

    def delete_card(self):
        requests.delete('https://api.trello.com/1/cards/'+ self.card_id, params = trello_authorisation)
    
    def update_card_list(self):
        update_card_parameters = {'key': os.environ.get('API_KEY'),'token': os.environ.get('TOKEN'), 'idList': self.progress['id']}
        requests.put('https://api.trello.com/1/cards/'+ self.card_id, params = update_card_parameters)




